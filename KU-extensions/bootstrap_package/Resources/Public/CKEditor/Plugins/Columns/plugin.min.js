"use strict";!function(){function t(e){var t=e.getSelection(),n=t&&t.getRanges()[0];if(n){for(var o,a=t.createBookmarks(!1)[0],r=a.startNode,l=a.endNode||r,s=n.createIterator(),n=e.editable(),u=[];o=s.getNextParagraph();)u.push(o);if(e.getCommand("bootstrappackage_columns").state==CKEDITOR.TRISTATE_OFF){var c=e,i=u,m=(i=function(e,t){var n=null,o=null,a=[];for(;0<t.length;){for(o=t.shift();!o.getParent().equals(e);)o=o.getParent();o.equals(n)||(a.push(o),n=o)}return a}(function(e){for(var t=e[0].getParent(),n=null,o=0;o<e.length;o++)n=e[o],t=t.getCommonAncestor(n.getParent());var a={table:1,tbody:1,tr:1,ol:1,ul:1};for(;a[t.getName()];)t=t.getParent();return t}(i),i),i=function(e,t){var n=null,o=[];for(;0<t.length;)if("div"==(n=t.shift()).getName()&&n.hasClass("text-column")){for(var a=new CKEDITOR.dom.documentFragment(e.document);n.getFirst();)a.append(n.getFirst().remove()),o.push(a.getLast());a.replace(n)}else o.push(n);return o}(c,i),i),g=c.document.createElement("div"),d=null;for(g.addClass("text-column"),g.insertBefore(m[0]);0<m.length;)d=m.shift(),g.append(d)}else for(var f=function(e){for(var t={},n=[],o=[],a=null,r=null,l=0;l<e.length;l++){a=e[l];var r=null,s=null;if("div"==a.getName()&&a.hasClass("text-column")&&v(a))n.push(a);else{for(;a.getParent();){if("div"==a.getParent().getName()&&a.getParent().hasClass("text-column")){r=a.getParent(),s=a;break}a=a.getParent()}r&&s&&!s.getCustomData("move")&&(o.push(s),CKEDITOR.dom.element.setMarker(t,s,"move",!0))}}CKEDITOR.dom.element.clearAllMarkers(t);for(;0<o.length;)a=o.shift(),r=a.getParent(),a.getPrevious()?a.getNext()?(a.breakParent(a.getParent()),n.push(a.getNext())):a.remove().insertAfter(r):a.remove().insertBefore(r),r.getCustomData("processed")||(n.push(r),CKEDITOR.dom.element.setMarker(t,r,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),n}(u),h=null,p=f.length-1;0<=p;p--)v(h=f[p])&&h.remove();n.contains(r)&&n.contains(l)&&t.selectBookmarks([a]),e.focus()}}function n(e,t){t=t.block||t.blockLimit,e=e.elementPath(t).contains(function(e){if(e.is("div")&&e.hasClass("text-column"))return!0},1);this.setState(e?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function v(e){for(var t,n=0,o=e.getChildCount();n<o&&(t=e.getChild(n));n++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return;return 1}CKEDITOR.plugins.add("bootstrappackage_columns",{lang:"en,de",icons:"columns",hidpi:!0,init:function(e){e.blockless||(e.addCommand("bootstrappackage_columns",{exec:t,refresh:n,context:"div(text-column)",allowedContent:"div(!text-column)",requiredContent:"div(!text-column)"}),e.ui.addButton&&e.ui.addButton("Columns",{label:e.lang.bootstrappackage_columns.toolbar,command:"bootstrappackage_columns",toolbar:"blocks"}))}})}();