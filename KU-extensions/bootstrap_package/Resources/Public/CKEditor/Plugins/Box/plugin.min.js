"use strict";!function(){function t(e){var t=e.getSelection(),a=t&&t.getRanges()[0];if(a){for(var r,n=t.createBookmarks(!1)[0],o=n.startNode,l=n.endNode||o,s=a.createIterator(),a=e.editable(),i=[];r=s.getNextParagraph();)i.push(r);if(e.getCommand("bootstrappackage_box").state==CKEDITOR.TRISTATE_OFF){var u=e,g=i,d=(g=function(e,t){var a=null,r=null,n=[];for(;0<t.length;){for(r=t.shift();!r.getParent().equals(e);)r=r.getParent();r.equals(a)||(n.push(r),a=r)}return n}(function(e){for(var t=e[0].getParent(),a=null,r=0;r<e.length;r++)a=e[r],t=t.getCommonAncestor(a.getParent());var n={table:1,tbody:1,tr:1,ol:1,ul:1};for(;n[t.getName()];)t=t.getParent();return t}(g),g),g=function(e,t){var a=null,r=[];for(;0<t.length;)if("div"==(a=t.shift()).getName()&&a.hasClass("well")){for(var n=new CKEDITOR.dom.documentFragment(e.document);a.getFirst();)n.append(a.getFirst().remove()),r.push(n.getLast());n.replace(a)}else r.push(a);return r}(u,g),g),c=u.document.createElement("div"),f=null;for(c.addClass("well"),c.insertBefore(d[0]);0<d.length;)f=d.shift(),c.append(f)}else for(var m=function(e){for(var t={},a=[],r=[],n=null,o=null,l=0;l<e.length;l++){n=e[l];var o=null,s=null;if("div"==n.getName()&&n.hasClass("well")&&v(n))a.push(n);else{for(;n.getParent();){if("div"==n.getParent().getName()&&n.getParent().hasClass("well")){o=n.getParent(),s=n;break}n=n.getParent()}o&&s&&!s.getCustomData("move")&&(r.push(s),CKEDITOR.dom.element.setMarker(t,s,"move",!0))}}CKEDITOR.dom.element.clearAllMarkers(t);for(;0<r.length;)n=r.shift(),o=n.getParent(),n.getPrevious()?n.getNext()?(n.breakParent(n.getParent()),a.push(n.getNext())):n.remove().insertAfter(o):n.remove().insertBefore(o),o.getCustomData("processed")||(a.push(o),CKEDITOR.dom.element.setMarker(t,o,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),a}(i),h=null,p=m.length-1;0<=p;p--)v(h=m[p])&&h.remove();a.contains(o)&&a.contains(l)&&t.selectBookmarks([n]),e.focus()}}function a(e,t){t=t.block||t.blockLimit,e=e.elementPath(t).contains(function(e){if(e.is("div")&&e.hasClass("well"))return!0},1);this.setState(e?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function v(e){for(var t,a=0,r=e.getChildCount();a<r&&(t=e.getChild(a));a++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return;return 1}CKEDITOR.plugins.add("bootstrappackage_box",{lang:"en,de",icons:"box",hidpi:!0,init:function(e){e.blockless||(e.addCommand("bootstrappackage_box",{exec:t,refresh:a,context:"div(well)",allowedContent:"div(!well)",requiredContent:"div(!well)"}),e.ui.addButton&&e.ui.addButton("Box",{label:e.lang.bootstrappackage_box.toolbar,command:"bootstrappackage_box",toolbar:"blocks"}))}})}();