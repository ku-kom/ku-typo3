"use strict";!function(){function t(e){var t=e.getSelection(),a=t&&t.getRanges()[0];if(a){for(var n,r,o=t.createBookmarks(!1)[0],l=o.startNode,s=o.endNode||l,i=a.createIterator(),u=e.editable(),g=[];n=i.getNextParagraph();)g.push(n);e.getCommand("bootstrappackage_box").state==CKEDITOR.TRISTATE_OFF?(r=e,a=function(e,t){var a=null,n=null,r=[];for(;0<t.length;){for(n=t.shift();!n.getParent().equals(e);)n=n.getParent();n.equals(a)||(r.push(n),a=n)}return r}(function(e){for(var t=e[0].getParent(),a=null,n=0;n<e.length;n++)a=e[n],t=t.getCommonAncestor(a.getParent());var r={table:1,tbody:1,tr:1,ol:1,ul:1};for(;r[t.getName()];)t=t.getParent();return t}(a=g),a),function(e){var t=r.document.createElement("div"),a=null;for(t.addClass("well"),t.insertBefore(e[0]);0<e.length;)a=e.shift(),t.append(a)}(a=function(e,t){var a=null,n=[];for(;0<t.length;)if("div"==(a=t.shift()).getName()&&a.hasClass("well")){for(var r=new CKEDITOR.dom.documentFragment(e.document);a.getFirst();)r.append(a.getFirst().remove()),n.push(r.getLast());r.replace(a)}else n.push(a);return n}(r,a))):function(e){for(var t=null,a=e.length-1;0<=a;a--)c(t=e[a])&&t.remove()}(function(e){for(var t={},a=[],n=[],r=null,o=null,l=0;l<e.length;l++){r=e[l];var o=null,s=null;if("div"==r.getName()&&r.hasClass("well")&&c(r))a.push(r);else{for(;r.getParent();){if("div"==r.getParent().getName()&&r.getParent().hasClass("well")){o=r.getParent(),s=r;break}r=r.getParent()}o&&s&&!s.getCustomData("move")&&(n.push(s),CKEDITOR.dom.element.setMarker(t,s,"move",!0))}}CKEDITOR.dom.element.clearAllMarkers(t);for(;0<n.length;)r=n.shift(),o=r.getParent(),r.getPrevious()?r.getNext()?(r.breakParent(r.getParent()),a.push(r.getNext())):r.remove().insertAfter(o):r.remove().insertBefore(o),o.getCustomData("processed")||(a.push(o),CKEDITOR.dom.element.setMarker(t,o,"processed",!0));return CKEDITOR.dom.element.clearAllMarkers(t),a}(g)),u.contains(l)&&u.contains(s)&&t.selectBookmarks([o]),e.focus()}}function a(e,t){t=t.block||t.blockLimit,t=e.elementPath(t).contains(function(e){if(e.is("div")&&e.hasClass("well"))return!0},1);this.setState(t?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}function c(e){for(var t,a=0,n=e.getChildCount();a<n&&(t=e.getChild(a));a++)if(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary())return;return 1}CKEDITOR.plugins.add("bootstrappackage_box",{lang:"en,de",icons:"box",hidpi:!0,init:function(e){e.blockless||(e.addCommand("bootstrappackage_box",{exec:t,refresh:a,context:"div(well)",allowedContent:"div(!well)",requiredContent:"div(!well)"}),e.ui.addButton&&e.ui.addButton("Box",{label:e.lang.bootstrappackage_box.toolbar,command:"bootstrappackage_box",toolbar:"blocks"}))}})}();